package gr.tracer.platform.components;

import eu.sqooss.service.db.StoredProject;
import gr.tracer.common.entities.db.MonitoredProjectList;
import gr.tracer.common.entities.db.ProjectFileVulnerability;
import gr.tracer.common.entities.db.SecurityLibrary;
import gr.tracer.common.entities.db.VulnerabilityType;
import gr.tracer.platform.TracerComponent;

import java.util.HashSet;
import java.util.List;

public interface VulnerabilityDetectionComponent extends TracerComponent {
	
	/**
	 * Record detected Vulnerability types to the database
	 * @param sProjVul A {@link java.util.List} of Project file vulnerabilities
	 * @return true or false whether the method executed successful or not
	 */
	public boolean addToDetectedVulnerabilities(List<ProjectFileVulnerability> sProjVul);
	
	/**
	 * Retrieve the Security libraries treating a Vulnerability type
	 * @param vtName The Vulnerability type's name
	 * @return A {@link java.util.HashSet} of Security libraries
	 */
	public HashSet<SecurityLibrary> getSecurityLibrariesTreatingVulnerabilityType(String vtName);

	/**
	 * Retrieve the Vulnerability types detected by a Security profile
	 * @param spName The Security profile's name
	 * @return A {@link java.util.HashSet} of Vulnerability types
	 */
	public HashSet<VulnerabilityType> getVulnerabilityTypesDetectedBySecurityProfile(String spName);
	
	/**
	 * 
	 * @param spName
	 * @return
	 */
	public MonitoredProjectList getMonitoredProjectListBySecurityProfile(String spName);
	
	/**
	 * 
	 * @param mplName
	 * @return
	 */
	public HashSet<StoredProject> getStoredProjectsOfMonitoredProjectList(String mplName);
}
