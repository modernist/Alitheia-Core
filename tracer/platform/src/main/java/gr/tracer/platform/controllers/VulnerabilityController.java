package gr.tracer.platform.controllers;

import java.util.List;

import gr.tracer.common.entities.Vulnerability;
import gr.tracer.common.entities.VulnerabilityList;
import gr.tracer.common.entities.db.SecurityLibrary;
import gr.tracer.common.entities.db.VulnerabilityType;
import gr.tracer.platform.components.SecurityLibraryComponent;
import gr.tracer.platform.components.VulnerabilityComponent;

public class VulnerabilityController {
	public VulnerabilityList _vList;
	private VulnerabilityComponent vc;
	private SecurityLibraryComponent slc;
	
	public List<VulnerabilityType> getVulnerabilityList() {
		return vc.getVulnerabilityList();
	}

	public VulnerabilityType getVulnerability(int aAVd_index) {
		return vc.getVulnerability(aAVd_index);
	}
	
	
	public boolean createVulnerability(String vName, String vDescription, String slName, String slDescription) {
		SecurityLibrary sl;
		VulnerabilityType vt;
		slc.createSecurityLibrary(slName, slDescription);
		sl = (SecurityLibrary) slc.searchSecurityLibrary(slName);		
		vc.createVulnerability(vName, vDescription);
		vt = searchVulnerability(vName);
		vc.addSecurityLibraryToVulnerabilityType(sl.getId(), vt.getId());
		return true;
	}

	public VulnerabilityType searchVulnerability(String aAName) {
		return (VulnerabilityType) vc.searchVulnerability(aAName);
	}

	public void addVulnerabilityToVulnerabilityList(Vulnerability aAVl) {
		throw new UnsupportedOperationException();
	}

}
